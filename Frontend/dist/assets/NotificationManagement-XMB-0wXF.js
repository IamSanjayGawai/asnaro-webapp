import{d as S,r as a,j as e,aG as W,h as X,z as Y,a as A,f as I,e as ee,u as te,S as se,aH as le}from"./index-w2wx-x_X.js";import{K as ae}from"./baseline-5AKzli58.js";import{R as ne}from"./index.esm-y_8cUbAG.js";import{u as ie}from"./useTableTheme-44lDDVWp.js";import"./emotion-react.browser.esm-kI5PoqX3.js";import"./hoist-non-react-statics.cjs-j2Vrlo-h.js";import"./extends-_9I-EFOp.js";import"./assertThisInitialized-4q6YPdh3.js";import"./memoize-one.esm-oV5jpQgL.js";import"./setPrototypeOf-ahVgEFUp.js";import"./iconBase-7AsOp5YA.js";const oe=({showModal:u,setShowModal:r,show:s=!0,idToTurnOnOff:x,delievryTurnOnOff:i})=>{const m=S(),[h]=a.useState(!0),g=async()=>{await m(W(x)),X.emit("newsToggle",{newsId:x},()=>{r(!1)})};return e.jsx(e.Fragment,{children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\r
            \r
            `,children:e.jsx("div",{className:"relative w-auto my-6 mx-auto max-w-3xl",children:e.jsxs("div",{className:"border-0  shadow-lg relative flex gap-5 flex-col w-full bg-white outline-none focus:outline-none",children:[e.jsx("div",{className:"flex items-start justify-between p-4  rounded-t",children:e.jsx("button",{className:"p-1 ml-auto bg-transparent border-0 text-black float-right text-3xl leading-none font-semibold outline-none focus:outline-none",onClick:()=>r(!1),children:e.jsx(ne,{})})}),h?e.jsxs("div",{className:"relative px-4 gap-5 flex-auto ",children:[e.jsx("h3",{className:"mb-6 text-[#255BB3] text-center font-noto-sans-jp font-bold text-[20px]",children:"ご賛同いただけますか？"}),e.jsx("p",{className:"text-[#808080] text-sm font-noto-sans-jp px-8 text-base font-[500]  w-2/3 mt-[4em] mb-[3em] mx-auto",children:` このニュースを送信することに同意しますか ${i?"非公開":"公開"}?

「はい」の場合は、「適用」ボタンをクリックします。 「いいえ」の場合は、「戻る」をクリックします。`})]}):e.jsxs("div",{className:"relative px-4 gap-5 flex-auto ",children:[e.jsx("h3",{className:"mb-6 text-[#255BB3] text-center font-noto-sans-jp font-bold text-[20px]",children:"ご賛同いただけますか？"}),e.jsx("p",{className:"text-[#808080] text-sm font-noto-sans-jp px-8 text-base font-[500]  w-2/3 mt-[4em] mb-[3em] mx-auto",children:`このニュースを送信することに同意しますか ${i?"非公開":"公開"} ?

「はい」の場合は、「適用」ボタンをクリックします。 「いいえ」の場合は、「戻る」をクリックします。`})]}),e.jsxs("div",{className:"grid grid-cols-1 justify-center p-4 w-2/3 mx-auto mb-8 ",children:[s&&e.jsx("button",{className:"bg-[#FFAA00] text-white  font-bold uppercase text-sm px-6 py-3 w-[348px]  outline-none  mx-auto mb-2",type:"submit",onClick:g,children:"適用する"}),e.jsx("button",{className:"bg-[#808080] text-white  font-bold uppercase text-sm px-6 py-3 w-[348px] mx-auto  outline-none mb-1",type:"button",onClick:()=>r(!1),children:"戻る"})]})]})})}),e.jsx("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"})]}):null})},ye=()=>{var F,O;const u=Y(),{loading:r}=A(I),{newsSearchData:s}=A(ee),x=S(),[i,m]=a.useState(!1),[h,g]=a.useState(null),[N,T]=a.useState(!1),[v,B]=a.useState(""),[P,E]=a.useState(""),[o,w]=a.useState(parseInt(new URLSearchParams(u.search).get("page"))||1),[f,L]=a.useState(5),M=ie("1fr 1fr 2fr",3),$=t=>B(t.target.value),D=t=>E(t.target.value),R=t=>{L(parseInt(t.target.value))},C=(t,l,c=!1)=>{const d={keyword:v,mod:P,currentPage:t,limit:l};console.log("page : ",t),c&&(console.log("reset true"),w(1)),x(le(d))},b=async t=>{w(t),p(`/admin/dashboard/notification-management?page=${t}`)},p=te(),k=((s==null?void 0:s.pagination)||{totalPages:0,currentPage:1}).totalPages,j=Math.max(1,o-Math.floor(10/2)),U=Math.min(k,j+10-1),V=Array.from({length:U-j+1},(t,l)=>j+l);a.useEffect(()=>{C(o,f,!1)},[x,o,i,N]);const z="http://localhost:8000",K=async()=>{try{if(!(s!=null&&s.data)||!Array.isArray(s==null?void 0:s.data)){console.log("Inquiries data is not available");return}const t=s==null?void 0:s.csvNews.map(l=>l._id);if(t.length>0){const l=await fetch(`${z}/admin/download/csv`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notice_ids:t,formType:"notification"})});if(!l.ok)throw new Error("Network response was not ok");const c=await l.blob(),d=window.URL.createObjectURL(c),n=document.createElement("a");n.href=d,n.setAttribute("download","notice_list.csv"),document.body.appendChild(n),n.click()}else console.log("No inquiry IDs found for CSV export")}catch(t){console.error("Error downloading CSV:",t)}},q=t=>{t.preventDefault(),b(1),C(1,f,!0)},_=(s==null?void 0:s.data)||[],G={nodes:_.map(t=>({id:(t==null?void 0:t._id)||"NA",delivery_ON_OFF:t==null?void 0:t.delivery_flag,title:(t==null?void 0:t.news_title)||"NA",delivery_date:(t==null?void 0:t.delivery_date)||"NA"}))},[,H]=a.useState({nodes:_}),J=(t,l,c,d)=>{H(n=>({...n,nodes:n.nodes.map(y=>y.id===l?{...y,[d]:t}:y)})),g(l),m(!0),T(c)},Z=[{label:"配信ON/OFF",key:"delivery_flag",renderCell:t=>e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"checkbox",checked:t.delivery_ON_OFF===!0,onChange:l=>J(l.target.checked,t.id,t.delivery_ON_OFF,"delivery_flag")})})},{label:"タイトル",key:"title",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400] line-clamp-3 text-center break-all",style:{whiteSpace:"normal"},onClick:()=>p(`/admin/dashboard/notification-management-detail/${t.id}`),children:t.title})},{label:"配信日",key:"delivery_date",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400] line-clamp-3 text-center",style:{whiteSpace:"normal"},onClick:()=>p(`/admin/dashboard/notification-management-detail/${t.id}`),children:Q(t.delivery_date)?new Date(t.delivery_date).toISOString().split("T")[0]:"Invalid date"})}];function Q(t){const l=new Date(t);return!isNaN(l.getTime())}return e.jsxs(e.Fragment,{children:[r?e.jsx(se,{}):e.jsxs("form",{onSubmit:q,className:"mb-40",children:[e.jsxs("div",{className:"lg:mx-20 md:mx-8 xs:mx-8 flex flex-col xs:mt-[24px] md:mt-[50px]",children:[e.jsx("h1",{className:"text-[#808080] font-[700] text-[24px] mb-4",children:"お知らせ管理"}),e.jsxs("div",{className:"w-full p-4 bg-[#F8F8F8] text-[#808080]",children:["検索条件設定",e.jsxs("div",{className:"xs:w-full sm:w-full md:w-[18rem] lg:w-[21rem] flex flex-col justify-start",children:[e.jsxs("div",{className:"flex lg:flex-row xs:flex-col md:flex-row lg:items-center justify-between mt-5",children:[e.jsx("label",{className:"text-[#808080] lg:text-[14px] xs:text-[12px]",children:"キーワード"}),e.jsx("input",{type:"text",className:"border lg:text-[14px] xs:text-[12px] xs:mt-[5px] lg:px-4 xs:px-1 lg:h-[30px] md:h-[30px] xs:h-[39px]",onChange:$})]}),e.jsxs("div",{className:"flex lg:flex-row lg:items-center lg:justify-start xs:justify-start md:justify-between mt-5 text-[#808080]",children:[e.jsx("label",{className:"text-[#808080] lg:text-[14px] xs:text-[12px]",children:"配信月"}),e.jsx("input",{type:"date",id:"first_name",className:"text-tertiary h-[25px] lg:text-[14px] xs:text-[12px] border-[1px] border-[#DCDCDC] px-10 outline-0 text-sm ml-[4.2rem]",placeholder:"鋳造",onChange:D})]}),e.jsxs("div",{className:"flex xs:flex-row lg:flex-col lg:items-center justify-between mt-5 mb-3 text-[#808080] lg:text-[14px] xs:text-[12px]",children:[e.jsxs("div",{className:"flex flex-row lg:w-full lg:gap-[3.4rem] xs:gap-3",children:[e.jsx("label",{className:"text-[#808080] lg:text-[14px] xs:text-[12px] xs:mt-[5px]",children:"表示件数"}),e.jsxs("div",{className:"flex flex-row md:flex-row items-center",children:[e.jsx("select",{id:"first_name",className:"text-tertiary border-[1px] h-[25px] border-[#DCDCDC] lg:px-4 xs:px-1 outline-0 lg:text-[14px] xs:text-[12px] bg-white focus:ring-0 focus:border",placeholder:"鋳造",value:f,onChange:R,children:[1,5,10,15,20,25,30,35,40,45,50].map((t,l)=>e.jsx("option",{value:t,children:t},l))}),e.jsx("span",{className:"ml-2",children:" 件"})]})]}),e.jsx("div",{className:"lg:w-full flex justify-end items-center lg:hidden xs:block lg:mt-2 lg:text-[14px] xs:text-[12px]",children:e.jsx("button",{className:"text-white bg-[#255BB3] lg:px-10 xs:px-2 py-1 l",type:"submit",children:"この条件で検索する"})})]})]}),e.jsx("div",{className:"lg:w-full flex justify-center items-center",children:e.jsx("button",{className:"text-white bg-[#255BB3] lg:px-10 xs:px-2 py-1 lg:mt-2 lg:text-[14px] xs:text-[12px] xs:hidden lg:block",type:"submit",children:"この条件で検索する"})})]})]}),e.jsxs("div",{className:"lg:mx-20 md:mx-8 xs:mx-8 mt-[3rem]   lg:min-w-[900px] ",children:[e.jsx("div",{className:"flex items-center justify-between sm:block ",children:e.jsxs("div",{className:"flex justify-end gap-2 text-center",children:[e.jsx("button",{type:"button",onClick:()=>p("/admin/dashboard/notification-management-create"),className:"text-white bg-[#255BB3] px-5 py-1 lg:text-[14px] xs:text-[12px]",children:"新規登録"}),e.jsx("button",{type:"button",onClick:K,className:"text-white bg-[#FFAA00] px-5 py-1 lg:text-[14px] xs:text-[12px]",children:"CSV出力"})]})}),e.jsx("div",{className:`mt-4  overflow-x-auto ${((F=s==null?void 0:s.data)==null?void 0:F.length)==0?"flex justify-center items-center":"  border-[1px] border-[#E6E6E6]"} `,children:((O=s==null?void 0:s.data)==null?void 0:O.length)==0?`${v}」に一致する結果はありません。別のキーワードをお試しください`:e.jsx(ae,{data:G,columns:Z,theme:M,layout:{custom:!0,horizontalScroll:!0}})}),e.jsxs("div",{className:"col-span-12 bg-[#F5F5F5] h-[60px] flex justify-center items-center gap-2 mt-[50px]",children:[e.jsx("div",{className:"flex gap-1",children:V.map((t,l)=>e.jsx("button",{type:"button",className:`border w-[25px] ${o===t?"bg-primary text-white":"bg-white"} border-[#DCDCDC]`,onClick:()=>b(t),children:t},l))}),o<k&&e.jsxs("div",{className:"flex gap-1 items-center cursor-pointer",onClick:()=>b(o+1),children:[e.jsx("div",{className:"font-[500] text-primary text-[16px] w-full",children:"次ページ"}),e.jsx("svg",{className:"",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"18",viewBox:"0 0 16 18",fill:"none",children:e.jsx("path",{d:"M15.4318 9L0.138137 17.6603L0.138138 0.339745L15.4318 9Z",fill:"#255BB3"})})]})]})]})]}),i?e.jsx(oe,{showModal:i,setShowModal:m,idToTurnOnOff:h,delievryTurnOnOff:N}):""]})};export{ye as default};
