import{u as L,z as oe,r as n,a as z,f as le,B as ie,d as ce,N as de,Q as me,D as pe,U as g,j as a,S as $,V as Q}from"./index-w2wx-x_X.js";import{r as xe,l as ue,K as fe}from"./baseline-5AKzli58.js";import{R as he,D as ge,T as ye,a as _e,C as we,b as be,c as je,d as ke}from"./CancelProgressReviewModal-Cx-jR9Sa.js";import{o as ve}from"./status-transaction-jP2MLjuh.js";import"./emotion-react.browser.esm-kI5PoqX3.js";import"./hoist-non-react-statics.cjs-j2Vrlo-h.js";import"./extends-_9I-EFOp.js";import"./assertThisInitialized-4q6YPdh3.js";import"./memoize-one.esm-oV5jpQgL.js";import"./setPrototypeOf-ahVgEFUp.js";import"./createLucideIcon-HB9nCie5.js";import"./tslib.es6-8dbh_m2m.js";import"./iconBase-7AsOp5YA.js";import"./index.esm-y_8cUbAG.js";const $e=()=>{var B,D,E,R,F,I;const y=L(),U=oe(),_=new URLSearchParams(U.search).get("page"),[m,q]=n.useState(_?parseInt(_):1),[w]=n.useState(null),[b,j]=n.useState(!1),[l,k]=n.useState(["10"]),{other:i,partnerResponse:O,loading:H}=z(le),[Z,p]=n.useState(!1),[K,v]=n.useState(!1),[V,C]=n.useState(!1),[G,J]=n.useState(""),[W,N]=n.useState(!1),[X,S]=n.useState(!1),[Y,x]=n.useState(!1),A=L(),{buerList:s,transactionStatus:o,statusLoading:ee,listLoading:te}=z(ie),r=ce(),M=10,u=Math.max(1,((B=s==null?void 0:s.pagination)==null?void 0:B.currentPage)-Math.floor(M/2)),f=Math.min((D=s==null?void 0:s.pagination)==null?void 0:D.totalPages,u+M-1),ae=Array.from({length:f-u+1},(e,t)=>u+t),c=async e=>{q(e),y(`/dashboard/purchase-list?page=${e}`)};n.useEffect(()=>{r(de({status:l,page:m})),r(me({status:l,role:"buyer"}))},[l,m,r]),n.useEffect(()=>{r(pe({}))},[r,O]),n.useEffect(()=>{r(g(!1))},[]),console.log(s,"buerList>>>>>>>>>>>>>>>"),console.log(o,"transactionStatus");let h=[];if(s&&(s!=null&&s.data))for(let e=0;e<(s==null?void 0:s.data.length);e++){const t=s==null?void 0:s.data[e];h.push({transaction_no:t._id,customer_id:t.customer_id,seller_id:t.seller_id,quotations:t.quotations,conversation:t.conversation,project:t.process_name,company_name:t.buyerDetails.name01,transaction_status:t.transaction_status,estimate_name:t.estimate_name,dept_name:t.dept_name,subtotal:t.subtotal,discount:t.discount,charge:t.charge,tax:t.tax,total:t.total,payment_total:t.payment_total,payment_id:t.payment_id,payment_method:t.payment_method,deliv_id:t.deliv_id,status:t.status,issue_date:t.issue_date,expiration_date:t.expiration_date,title:t.title,estimate_number:t.estimate_number,latestQuoteTotalExcludingTax:t.transaction_status===5&&t.refund&&t.refund.taxDetails&&t.refund.taxDetails.totalAmountIncludingTax!==0?t.latestQuoteTotalExcludingTax-t.refund.taxDetails.totalAmountExcludingTax:t.latestQuoteTotalExcludingTax,del_flg:t.del_flg,order_id:t.order_id,zip01:t.zip01,zip02:t.zip02,pref:t.pref,addr01:t.addr01,addr02:t.addr02,transport_costs:t.transport_costs,contract_agree:t.contract_agree,orderer_agree:t.orderer_agree,estimation_pdf:t.estimation_pdf,createdAt:t.createdAt,updatedAt:t.updatedAt,paymentDeposit:t.paymentDeposit,est_amount:52e4,deadline:"21/06/2024",detailed:"詳細",review:"レビュー",cancel:"キャンセル",__v:t.__v})}console.log((E=s==null?void 0:s.data)==null?void 0:E.map(e=>e.paymentDeposit),"nodes>>>>>>>>>>>>>>>");const se=[{label:"取引No",key:"transaction_no",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] break-all",style:{whiteSpace:"normal"},children:e.transaction_no?e.transaction_no:"NA"})},{label:"工程",key:"project",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] text-left line-clamp-3",style:{whiteSpace:"normal"},children:e.project?e.project:"NA"})},{label:"企業名",key:"company_name",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] text-left line-clamp-3",style:{whiteSpace:"normal"},children:e.company_name?e.company_name:"NA"})},{label:"ステータス",key:"transaction_status",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] line-clamp-1",style:{whiteSpace:"normal"},children:ve[e.transaction_status]||"NA"})},{label:"納期",key:"deadline",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400]",style:{whiteSpace:"normal"},children:e.deadline?e.deadline:"NA"})},{label:"見積金額(税別)",key:"est_amount",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] break-all",style:{whiteSpace:"normal"},children:e.latestQuoteTotalExcludingTax})},{label:"詳細",key:"detailed",renderCell:e=>a.jsxs("button",{onClick:()=>y(`/transaction/${e.transaction_no}`),className:"text-[#fff] text-[14px] font-[400] bg-[#FFAA00] px-2 py-1 flex gap-2 items-center  justify-center mx-auto",style:{whiteSpace:"normal"},children:[e.detailed,a.jsx("span",{className:"",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"5",height:"8",viewBox:"0 0 5 8",fill:"none",children:a.jsx("path",{d:"M0.184686 7.38979C0.0700362 7.28623 0.00946618 7.16632 0.00513976 7.02643C0.00081333 6.88654 0.0613833 6.76663 0.184686 6.66308L3.46196 3.91066L0.184686 1.15825C0.0700362 1.06015 0.00946618 0.940239 0.00081333 0.798531C-0.00783952 0.656822 0.0527305 0.533282 0.17387 0.431542C0.290684 0.327986 0.433456 0.2753 0.606513 0.271666C0.77957 0.268033 0.924506 0.318902 1.03916 0.422458L4.84641 3.6109C4.89617 3.65268 4.9351 3.69992 4.96106 3.7526C4.98702 3.80529 5 3.85798 5 3.91248C5 3.96698 4.98702 4.01967 4.96106 4.07236C4.9351 4.12504 4.89833 4.17046 4.84641 4.21407L1.04997 7.39887C0.935322 7.49516 0.792549 7.54421 0.621656 7.54421C0.450762 7.54421 0.305826 7.49334 0.182523 7.38979H0.184686Z",fill:"white"})})})]})},{label:"レビュー",key:"review",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[500] w-fit bg-[#E6E6E6] p-1 text-center mx-auto cursor-pointer",style:{whiteSpace:"normal"},onClick:()=>{e.paymentDeposit?e.transaction_status===5?S(!0):e.transaction_status===6?N(!0):e.transaction_status===8?(A(`/transaction/${e.transaction_no}`),r(g(!0)),r(Q(!1))):x(!0):x(!0)},children:e.review})},{label:"キャンセル",key:"cancel",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[13px] font-[500] w-fit bg-[#E6E6E6] p-1 text-center mx-auto cursor-pointer",onClick:()=>{e.paymentDeposit?e.transaction_status===5?(v(!0),J(e.transaction_no)):e.transaction_status===6||e.transaction_status===8?C(!0):e.transaction_status!==7&&e.transaction_status!==9?(A(`/transaction/${e.transaction_no}`),r(Q(!0)),r(g(!1))):p(!0):p(!0)},style:{whiteSpace:"normal"},children:e.transaction_status===7||e.transaction_status===9?" ":e.cancel})}];let T=h;w!==null&&(T=h.filter(e=>e.transaction_status.toString()===w));const ne={nodes:T},re=xe([ue(),{HeaderRow:`
        background-color: #255BB3;
        color: #fff;
        font-size: 14px;

      `,Table:`
      --data-table-library_grid-template-columns:1.7fr 1.5fr 1.5fr 1.5fr 1.5fr 1fr 1.2fr 1.5fr 1.5fr;

    @media (max-width: 1150px) {
      --data-table-library_grid-template-columns:repeat(9,minmax(10px,500px));
        overflow-x: auto;
        width: 200% !important;
        white-space: nowrap;
      } 
      @media (max-width: 500px) {
        --data-table-library_grid-template-columns:repeat(9,minmax(10px,500px));
        overflow-x: auto;
        width: 300% !important;
        white-space: nowrap;
      }    
      `,BaseCell:`
         &:nth-of-type(n) {
          font-weight: 500;
          text-align:center;
            align-items:start;
          }
        &:nth-of-type(6) {
            text-align:right;
        }
         &:nth-of-type(1) {
            text-align:left;
          }

      `}]),P=[{label:"ALL",key:["10"]},{label:"商談中",key:["1"]},{label:"受発注待ち",key:["2"]},{label:"納品待ち",key:["3"]},{label:"検収中",key:["4"]},{label:"差戻し",key:["5"]},{label:"取引完了",key:["6"]},{label:"キャンセル",key:["7","9"]},{label:"決済完了",key:["8"]}];return a.jsxs(a.Fragment,{children:[H&&ee?a.jsx($,{}):i&&((R=i==null?void 0:i.user)!=null&&R.partner_flg)?a.jsxs("div",{className:"mx-8 mt-[-0.5rem]",children:[a.jsxs("div",{className:"flex items-center justify-between sm:block my-4",children:[a.jsx("h1",{className:"sm:text-[#255BB3] text-[#808080] font-[700] sm:text-[24px] text-xl mb-4 md:mb-0",children:"受注一覧"}),a.jsxs("div",{className:"flex items-center gap-2 sm:hidden",children:[a.jsxs("h1",{className:"text-[#808080] text-sm font-medium",children:["Filter By :"," "]}),a.jsx("button",{onClick:()=>j(!b),className:"text-white bg-[#FFAA00] px-6 py-1 ",children:a.jsx(he,{className:"w-6 h-6"})})]})]}),a.jsx("div",{className:"text-[14px] hidden sm:block font-medium text-center text-[#808080] border-b border-gray-200 dark:text-gray-400 dark:border-gray-700",children:a.jsx("ul",{className:"flex flex-wrap -mb-px gap-2 mt-4",children:P.map(e=>a.jsx("li",{className:"me-2",children:a.jsxs("span",{className:`inline-block p-1 text-[14px] ${(Array.isArray(e.key)?e.key.some(t=>l.includes(t)):l.includes(e.key))?"border-b-2 border-[#255BB3] text-[#255BB3]":"border-transparent"} rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 cursor-pointer`,onClick:t=>{t.preventDefault(),k(Array.isArray(e.key)&&e.key.length>1?e.key:Array.isArray(e.key)&&e.key.length===1?[e.key[0]]:[e.key.toString()]),c(1)},children:[e.label,"(",o&&(o!=null&&o.countInfo)?o==null?void 0:o.countInfo.reduce((t,d)=>Array.isArray(e.key)?t+(e.key.includes(d.status.toString())?d.count:0):t+(d.status===parseInt(e.key)?d.count:0),0):0,")"]})},Array.isArray(e.key)?e.key.join("-"):e.key))})}),a.jsx("div",{className:"sm:hidden block",children:a.jsx(ge,{isOpen:b,setIsOpen:j,statusLabels:P,setFilter:k,handlePageChange:c})}),te?a.jsx($,{className:"h-full"}):a.jsx("div",{className:"mt-4 border-[1px] border-[#E6E6E6] overflow-x-auto",children:a.jsx(fe,{data:ne,columns:se,theme:re})}),a.jsxs("div",{className:"col-span-12 bg-[#F5F5F5] h-[60px] flex justify-center items-center gap-2 mt-[50px]",children:[a.jsx("div",{className:"flex gap-1",children:ae.map((e,t)=>a.jsx(a.Fragment,{children:a.jsx("button",{className:`border w-[25px] ${m===e?"bg-primary text-white":"bg-white"} border-[#DCDCDC]`,onClick:()=>c(e),children:e},t)}))}),f<s&&((I=(F=s.transactions)==null?void 0:F.pagination)==null?void 0:I.totalPages)&&a.jsxs("div",{className:"flex gap-1 items-center cursor-pointer",onClick:()=>c(f+1),children:[a.jsx("div",{className:"font-[500] text-primary text-[16px] w-full",children:"次ページ"}),a.jsx("svg",{className:"",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"18",viewBox:"0 0 16 18",fill:"none",children:a.jsx("path",{d:"M15.4318 9L0.138137 17.6603L0.138138 0.339745L15.4318 9Z",fill:"#255BB3"})})]})]})]}):a.jsx("div",{className:"flex justify-center xs:gap-2 md:gap-10 w-full h-screen my-[75px]",children:"Become a partner to view this page"}),a.jsx(ye,{cancelModalshow:Z,setCancelModal:p}),a.jsx(_e,{reviewModalshow:Y,setReviewModal:x}),a.jsx(we,{cancelProgressshow:X,setCancelProgressModal:S}),a.jsx(be,{cancelProgressshow:K,setCancelProgressModal:v,transactionId:G}),a.jsx(je,{completedTransactionModalshow:V,setCompletedTransactionModal:C}),a.jsx(ke,{completedTransactionModalshow:W,setCompletedTransactionModal:N})]})};export{$e as default};
