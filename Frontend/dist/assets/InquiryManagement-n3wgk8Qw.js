import{d as v,r as a,j as e,aY as M,a as y,f as R,ae as D,z as U,u as O,aZ as V,S as q}from"./index-w2wx-x_X.js";import{K as z}from"./baseline-5AKzli58.js";import{R as $}from"./index.esm-y_8cUbAG.js";import{u as Z}from"./useTableTheme-44lDDVWp.js";import"./emotion-react.browser.esm-kI5PoqX3.js";import"./hoist-non-react-statics.cjs-j2Vrlo-h.js";import"./extends-_9I-EFOp.js";import"./assertThisInitialized-4q6YPdh3.js";import"./memoize-one.esm-oV5jpQgL.js";import"./setPrototypeOf-ahVgEFUp.js";import"./iconBase-7AsOp5YA.js";const G=({showModal:x,setShowModal:s,show:d=!0,idToDelete:f})=>{const i=v(),[o]=a.useState(!0);return e.jsx(e.Fragment,{children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\r
            \r
            `,children:e.jsx("div",{className:"relative w-auto my-6 mx-auto max-w-3xl",children:e.jsxs("div",{className:"border-0  shadow-lg relative flex gap-5 flex-col w-full bg-white outline-none focus:outline-none",children:[e.jsx("div",{className:"flex items-start justify-between p-4  rounded-t",children:e.jsx("button",{className:"p-1 ml-auto bg-transparent border-0 text-black float-right text-3xl leading-none font-semibold outline-none focus:outline-none",onClick:()=>s(!1),children:e.jsx($,{})})}),o?e.jsxs("div",{className:"relative px-4 gap-5 flex-auto ",children:[e.jsx("h3",{className:"mb-6 text-[#255BB3] text-center font-noto-sans-jp font-bold text-[20px]",children:"本気ですか？ ×"}),e.jsx("p",{className:"text-[#808080] text-sm font-noto-sans-jp px-8 text-base font-[500]  w-2/3 mt-[4em] mb-[3em] mx-auto",children:"本当にこれらのレコードを削除してもよろしいですか?このプロセスを元に戻すことはできません。"})]}):e.jsxs("div",{className:"relative px-4 gap-5 flex-auto ",children:[e.jsx("h3",{className:"mb-6 text-[#255BB3] text-center font-noto-sans-jp font-bold text-[20px]",children:"本気ですか？ ×"}),e.jsx("p",{className:"text-[#808080] text-sm font-noto-sans-jp px-8 text-base font-[500]  w-2/3 mt-[4em] mb-[3em] mx-auto",children:"工程を登録するには、パートナー登録をする必要があります 下記ボタンから、パートナー申請をお願いいたします"})]}),e.jsxs("div",{className:"grid grid-cols-1 justify-center p-4 w-2/3 mx-auto mb-8 ",children:[d&&e.jsx("button",{className:"bg-[#FFAA00] text-white  font-bold uppercase text-sm px-6 py-3 w-[348px]  outline-none  mx-auto mb-2",type:"submit",onClick:()=>{i(M(f)),s(!1)},children:"削除を申請する"}),e.jsx("button",{className:"bg-[#808080] text-white  font-bold uppercase text-sm px-6 py-3 w-[348px] mx-auto  outline-none mb-1",type:"button",onClick:()=>s(!1),children:"戻る"})]})]})})}),e.jsx("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"})]}):null})},ae=()=>{const{loading:x}=y(R),{allinquiryData:s}=y(D),d=U(),i=new URLSearchParams(d.search).get("page"),[o,C]=a.useState(i?parseInt(i):1),S=Z("1fr 2fr 2fr 2fr 2fr 3fr 1fr",7),k=O(),[p,b]=a.useState(!1),[A,_]=a.useState(null);console.log("allinquiryData",s);const E=v();console.log(s,"++++++++++++dispatch++++++++++++"),a.useEffect(()=>{E(V(o))},[p,o]);const j=10,u=Math.max(1,(s==null?void 0:s.currentPage)-Math.floor(j/2)),h=Math.min(s==null?void 0:s.totalPages,u+j-1),I=Array.from({length:h-u+1},(t,n)=>u+n),g=async t=>{C(t),k(`/admin/dashboard/inquiry-management?page=${t}`)},P="http://localhost:8000",T=async()=>{var t;try{if(!(s!=null&&s.inquiries)||!Array.isArray(s.inquiries)){console.error("Inquiries data is not available");return}const n=(t=s==null?void 0:s.csvInquiries)==null?void 0:t.map(l=>l._id);if(n.length>0){const l=await fetch(`${P}/admin/download/csv`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({process_ids:n,formType:"inquiry"})});if(!l.ok)throw new Error("Network response was not ok");const c=await l.blob(),r=window.URL.createObjectURL(c),m=document.createElement("a");m.href=r,m.setAttribute("download","inquiries_list.csv"),document.body.appendChild(m),m.click()}else console.log("No inquiry IDs found for CSV export")}catch(n){console.error("Error downloading CSV:",n)}};let w=[];a.useEffect(()=>{if(s!=null&&s.inquiries&&Array.isArray(s.inquiries)){const t=s.inquiries.map(n=>({...n,situation:"未読",date_time:n.createdAt||"NA",fullname:n.name||"NA",member_id:n._id||"NA",delete:"削除"}));N({nodes:t})}},[s]),console.log("admin all enquries component",w);const[F,N]=a.useState({nodes:w}),B=(t,n,l)=>{N(c=>({...c,nodes:c.nodes.map(r=>r.member_id===n?(_(n),{...r,[l]:t}):r)})),b(!0)},L=[{label:e.jsx("span",{className:"flex justify-center items-center",children:"状況"}),key:"situation",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400]  line-clamp-3  ",style:{whiteSpace:"normal"},children:t.situation})},{label:"日時",key:"date_time",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400]  line-clamp-3  ",style:{whiteSpace:"normal"},children:new Date(t.date_time).toISOString().split("T")[0]})},{label:"氏名",key:"fullname",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400]  line-clamp-3  ",style:{whiteSpace:"normal"},children:t.fullname})},{label:"会員ID",key:"member_id",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400]  line-clamp-3  ",style:{whiteSpace:"normal"},children:t.member_id})},{label:"メールアドレス",key:"email",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400]  line-clamp-3  ",style:{whiteSpace:"normal"},children:t.email})},{label:e.jsx("span",{className:"flex justify-center items-center",children:"内容"}),key:"message",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400]  line-clamp-3  text-center ",style:{whiteSpace:"normal"},children:t.message})},{label:"削除",key:"delete",renderCell:t=>e.jsx("div",{className:"text-[#808080] text-[12px] font-[400]  line-clamp-3 text-center  bg-[#D9D9D9] py-1 px-2 cursor-pointer",style:{whiteSpace:"normal"},onClick:()=>B(t.member_id,t.member_id,"member_id"),children:t.delete})}];return e.jsxs(e.Fragment,{children:[x?e.jsx(q,{}):e.jsxs("div",{className:"w-full mb-40 ",children:[e.jsx("div",{className:"lg:mx-20 md:mx-8 xs:mx-8 flex  flex-col xs:mt-[24px] md:mt-[50px]",children:e.jsx("h1",{className:"text-[#808080] font-[700] text-[24px] mb-4",children:"お問い合わせ管理"})}),e.jsxs("div",{className:" lg:mx-20 md:mx-8 xs:mx-8 mt-[3rem]  lg:min-w-[900px]",children:[e.jsxs("div",{className:"flex items-center justify-between sm:block ",children:[e.jsx("h1",{className:"sm:text-[#808080] text-[#808080] font-[700] sm:text-[24px] text-xl  md:mb-0"}),e.jsx("div",{className:"flex  justify-end gap-2 ",children:e.jsx("button",{onClick:T,className:"text-white bg-[#FFAA00] px-5 py-1 lg:text-[14px] xs:text-[12px]",children:"CSV出力"})})]}),e.jsx("div",{className:"mt-4 border-[1px] border-[#E6E6E6] overflow-x-auto",children:e.jsx(z,{data:F,columns:L,theme:S,layout:{custom:!0,horizontalScroll:!0}})}),e.jsxs("div",{className:"col-span-12 bg-[#F5F5F5] h-[60px] flex justify-center items-center gap-2 mt-[50px]",children:[e.jsx("div",{className:"flex gap-1",children:I.map((t,n)=>e.jsx("button",{className:`border w-[25px] ${o===t?"bg-primary text-white":"bg-white"} border-[#DCDCDC]`,onClick:()=>g(t),children:t},n))}),h<(s==null?void 0:s.totalPages)&&e.jsxs("div",{className:"flex gap-1 items-center cursor-pointer",onClick:()=>g(h+1),children:[e.jsx("div",{className:"font-[500] text-primary text-[16px] w-full",children:"次ページ"}),e.jsx("svg",{className:"",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"18",viewBox:"0 0 16 18",fill:"none",children:e.jsx("path",{d:"M15.4318 9L0.138137 17.6603L0.138138 0.339745L15.4318 9Z",fill:"#255BB3"})})]})]})]})]}),p?e.jsx(G,{showModal:p,setShowModal:b,idToDelete:A}):""]})};export{ae as default};
