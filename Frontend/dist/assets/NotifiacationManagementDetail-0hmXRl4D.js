import{a as R,e as Z,r,n as B,d as M,u as V,b0 as G,j as e,S as H,b1 as J}from"./index-w2wx-x_X.js";import{D as K}from"./Dropzone-MJ6J4G2E.js";import{u as L}from"./index.esm-aRdTVIgd.js";import"./tslib.es6-8dbh_m2m.js";const Y=()=>{var b,N,F,S,I,k;const{adminNewsDetails:t,loading:C}=R(Z),[m,h]=r.useState(!0),[u,T]=r.useState(null),[w,j]=r.useState(!1),[v,q]=r.useState(!1),[a,d]=r.useState({_id:"",news_date:new Date,rank:0,news_title:"",news_comment:"",news_select:"",creator_id:"",create_date:new Date,image:null,del_flg:0,shop_id:0,delivery_flag:!1,delivery_date:"",news_url:"",__v:0}),{register:c,setValue:n,reset:A,handleSubmit:E,formState:{errors:s}}=L(),{id:_}=B(),g=M(),z=V();r.useEffect(()=>{window.scrollTo(0,0),g(G(_))},[g,_,v]),r.useEffect(()=>{var l,x;t!=null&&t.news&&(n("news_title",t.news.news_title),n("news_comment",t.news.news_comment),n("delivery_date",new Date((l=t.news)==null?void 0:l.delivery_date).toISOString().split("T")[0]),n("delivery_flag",(x=t==null?void 0:t.news)==null?void 0:x.delivery_flag),d(p=>{var i,o;return{...p,...t.news,delivery_flag:((i=t==null?void 0:t.news)==null?void 0:i.delivery_flag)||!1,delivery_date:new Date((o=t.news)==null?void 0:o.delivery_date).toISOString().split("T")[0]}}))},[t,n]);const f=l=>{const{name:x,value:p}=l.target;d(i=>({...i,[x]:p}))},O=async l=>{var p;const x=new FormData;Object.entries(l).forEach(([i,o])=>{i==="image"?u?x.append("image",u):x.append("noImage",m||w?"false":"true"):x.append(i,o.toString())}),await g(J({formData:x,id:(p=t==null?void 0:t.news)==null?void 0:p._id})),A(),h(!0),q(!v)},P=(l,x)=>{x===1&&(T(l),n("image",l))},y=l=>{d(x=>({...x,delivery_flag:l}))};return console.log("prevImg1",m),console.log("dropZoneImg",w),e.jsx(e.Fragment,{children:C?e.jsx(H,{}):e.jsxs("div",{className:"lg:w-[80%] xl:w-[78%] xs:w-[100%] mb-40",children:[e.jsx("div",{className:"lg:mx-20 md:mx-8 xs:mx-8 flex flex-col mt-[50px]",children:e.jsxs("div",{className:"flex lg:gap-20 xs:gap-2 items-center",children:[e.jsx("h1",{className:"text-[#808080] font-[700] text-[20px] mb-4",children:"お知らせ編集画面"}),e.jsx("h3",{className:"text-[#FF8080] text-[10px]",children:"※は回答必須"})]})}),e.jsx("div",{className:"lg:mx-20 md:mx-8 xs:mx-8 mt-[1rem] lg:w-[100%] xs:w-[85%] sm:w-[80%] ",children:e.jsxs("form",{encType:"multipart/form-data",onSubmit:E(O),children:[e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsxs("div",{className:"flex xs:flex-col lg:flex-row",children:[e.jsx("label",{className:"text-[#808080] gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"タイトル"}),e.jsx("input",{type:"text",className:"border outline-0 lg:w-[253px] xs:w-full h-[36px] px-5 xs:mt-[16px] lg:ml-[50px] lg:text-[14px] xs:text-[12px]",...c("news_title",{required:"タイトルは必須です"}),name:"news_title",onChange:f}),(s==null?void 0:s.news_title)&&e.jsx("p",{className:"text-red-500",children:(b=s==null?void 0:s.news_title)==null?void 0:b.message})]}),e.jsxs("div",{className:"flex items-start xs:flex-col lg:flex-row",children:[e.jsx("label",{className:"text-[#808080] gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"画像"}),e.jsxs("div",{className:"bg-light relative cursor-pointer col-span-4 flex justify-center items-center xs:mt-[16px] lg:w-[219px] xs:w-[114px] border border-secondary xs:h-[116px] md:h-[140px] lg:ml-[80px]",children:[m&&((N=t==null?void 0:t.news)!=null&&N.image)?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("img",{className:"object-cover w-full h-full",src:(F=t==null?void 0:t.news)==null?void 0:F.image,alt:"image1"})}):e.jsx("div",{className:"w-full h-full cursor-pointer",children:e.jsx(K,{setValue:n,id:1,onFileSelect:l=>P(l,1),...c("image"),isProcess:!0,setDropZoneImg:j})}),m&&((S=t==null?void 0:t.news)==null?void 0:S.image)&&e.jsxs("svg",{className:"absolute top-0 right-0 mr-[2px] cursor-pointer",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:()=>{h(!1),j(!1)},children:[e.jsx("circle",{cx:"10",cy:"10",r:"10",fill:"black",fillOpacity:"0.5"}),e.jsx("line",{x1:"14.3536",y1:"5.35355",x2:"5.35355",y2:"14.3536",stroke:"white"}),e.jsx("line",{y1:"-0.5",x2:"12.7279",y2:"-0.5",transform:"matrix(0.707107 0.707107 0.707107 -0.707107 6 5)",stroke:"white"})]})]})]}),e.jsxs("div",{className:"flex items-start xs:flex-col lg:flex-row",children:[e.jsx("label",{className:"text-[#808080] gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"内容"}),e.jsx("textarea",{className:"border outline-0 lg:w-[650px] xs:w-full h-[230px] p-5 xs:mt-[16px] lg:ml-[80px] lg:text-[14px] xs:text-[12px] resize-none",...c("news_comment",{required:"内容は必須です"}),name:"news_comment",onChange:f}),(s==null?void 0:s.news_comment)&&e.jsx("p",{className:"text-red-500",children:(I=s==null?void 0:s.news_comment)==null?void 0:I.message})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("label",{className:"text-[#808080] flex gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:["公開ステータス",e.jsx("span",{className:"text-[#FF8080]",children:"※"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"radio",name:"delivery_flag",checked:(a==null?void 0:a.delivery_flag)===!0,value:"true",...c("delivery_flag",{required:"公開ステータスは必須です"}),className:"border outline-0 ml-[50px] xs:mt-[16px]",onChange:()=>y(!0)}),e.jsx("span",{className:"text-[#808080] lg:text-[14px] xs:text-[12px] ml-[9px]",children:"公開"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"radio",name:"delivery_flag",checked:(a==null?void 0:a.delivery_flag)===!1,value:"false",...c("delivery_flag",{required:"公開ステータスは必須です"}),className:"border outline-0 ml-[50px] xs:mt-[16px]",onChange:()=>y(!1)}),e.jsx("span",{className:"text-[#808080] lg:text-[14px] xs:text-[12px] ml-[9px]",children:"非公開"})]}),(s==null?void 0:s.delivery_flag)&&e.jsx("p",{className:"text-red-500",children:(k=s==null?void 0:s.delivery_flag)==null?void 0:k.message})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"text-[#808080] gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"配信日"}),e.jsx("input",{type:"date",className:"border outline-0 lg:w-[150px] xs:w-[150px] h-[36px] px-5 xs:mt-[16px] ml-[65px] lg:text-[14px] xs:text-[12px]",placeholder:"20",...c("delivery_date",{required:"配信日は必須です"}),name:"delivery_date",value:a.delivery_date,onChange:f})]})]}),e.jsxs("div",{className:"lg:w-[100%] xs:w-full flex justify-center items-center lg:gap-[46px] xs:gap-[10px] mt-[85px]",children:[e.jsx("button",{type:"button",className:"px-5 bg-[#808080] text-[#F8F8F8] xs:w-[161px] lg:w-[194px] h-[36px] lg:text-[14px] xs:text-[12px]",onClick:()=>{z("/admin/dashboard/notification-management")},children:"戻る"}),e.jsx("button",{type:"submit",className:"px-2 bg-[#FFAA00] text-[#F8F8F8] xs:w-[161px] lg:w-[194px] h-[36px] lg:text-[14px] xs:text-[12px]",children:"この内容で登録する"})]})]})})]})})};export{Y as default};
