import{u as O,d as Q,z as V,R as r,m as g,j as t,S as W,p as X}from"./index-w2wx-x_X.js";import{c as B}from"./react-datepicker-ubiZFbCm.js";import{B as f}from"./baseUrl-KJcG7PYP.js";import{d as E}from"./dayjs.min-5rCsLmx2.js";import"./index-XS26vnIA.js";import"./defineProperty-VwQjyvUu.js";import"./assertThisInitialized-4q6YPdh3.js";import"./setPrototypeOf-ahVgEFUp.js";const ne=()=>{const w=O(),_=Q(),A=V(),x=new URLSearchParams(A.search),[M,v]=r.useState(!0),[Y,S]=r.useState(!0),[y,L]=r.useState([]),[o,R]=r.useState("all"),[l,T]=r.useState([]),[c,m]=r.useState([]),[j,U]=r.useState([]),[p,z]=r.useState("all"),[H,P]=r.useState([]),[C,q]=r.useState(""),[N,K]=r.useState(x.get("keyword")?x.get("keyword"):""),[h,G]=r.useState(x.get("startDate")?new Date(x.get("startDate")):""),[u,I]=r.useState(x.get("endDate")?new Date(x.get("endDate")):"");r.useEffect(()=>{(async()=>{try{const s=await g.get(`${f}/areas/states`);L(s==null?void 0:s.data)}catch(s){console.error("Error fetching categories:",s)}})()},[]),r.useEffect(()=>{b(p)},[]),r.useEffect(()=>{F(o)},[]),r.useEffect(()=>{(async()=>{try{const s=await g.get(`${f}/categories/all`);U(s.data)}catch(s){console.error("Error fetching categories:",s)}})()},[]);const F=async e=>{R(e),S(!0),console.log("state selected",e);try{const s=await g.get(`${f}/areas/areas-city/${encodeURIComponent(e)}`);T(s.data),S(!1)}catch(s){console.error("Error fetching cities:",s)}},b=async e=>{z(e),v(!0);try{const s=await g.get(`${f}/categories/subcategories/${e}`);P(s.data),v(!1)}catch(s){console.error("Error fetching subcategories:",s)}},D=(e,s)=>{if(e==="all"){if(c.length===(l==null?void 0:l.map(a=>a==null?void 0:a.cities).flat().length))return m([]);{const a=l.map(i=>i.cities).flat();return m(a.filter(i=>i!=="all"))}}if(e==="area"){const a=l.find(d=>d.area===s),i=(a==null?void 0:a.cities)||[];return i.every(d=>c.includes(d))&&c.length>0?m(c.filter(d=>!i.includes(d))):m(d=>[...d,...i.filter(J=>!d.includes(J))])}const n=c.includes(e);m(n?a=>a.filter(i=>i!==e):a=>[...a,e])},k=j.map(e=>e.category_id),$=e=>{if(e.preventDefault(),h>u&&u!==""){alert("Start date cannot be greater than end date");return}_(X({startDate:E(h).format("YYYY-MM-DD"),endDate:E(u).format("YYYY-MM-DD"),keyword:N,cat:p==="all"?k:[p],subCat:C,pref:o==="all"?y:[o],mun:c==="all"?c:[c],pageSize:12})),w(`/process/search-results?keyword=${N}&startDate=${h}&endDate=${u}&cat=${p==="all"?k:[p]}&subCat=${C}&pref=${o==="all"?y:[o]}&mun=${c==="all"?c:[c]}`)};return console.log(o,"selectedState"),console.log(c,"selectedCities"),t.jsx(t.Fragment,{children:M||Y?t.jsx(W,{}):t.jsx("div",{className:"flex justify-center flex-col  items-center border-b border-secondary",children:t.jsxs("div",{className:"md:block max-w-[1200px] w-full xs:px-4 sm:px-6 md:px-8 xs:py-3 md:py-5 lg:py-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-[#255BB3] my-10 xs:text-center lg:text-left",children:"詳細検索"}),t.jsxs("form",{onSubmit:$,className:"mb-10",children:[t.jsx("div",{className:"mt-4",children:t.jsxs("div",{className:"grid grid-cols-[112px,1fr] sm:gap-8 items-center",children:[t.jsx("h3",{className:"text-[#808080] text-sm",children:"キーワード"}),t.jsx("input",{type:"text",id:"first_name",className:"text-tertiary border-[1px] border-[#DCDCDC] p-2 rounded-[5px] outline-0  text-sm sm:w-2/3",placeholder:"例：切削加工",value:N,onChange:e=>K(e.target.value)})]})}),t.jsx("div",{className:"mt-4",children:t.jsxs("div",{className:"grid grid-cols-[112px,1fr] sm:gap-8 items-center",children:[t.jsx("h3",{className:"text-[#808080] text-sm",children:"日程"}),t.jsxs("div",{className:"flex gap-2 sm:flex-wrap items-center  ",children:[t.jsx("div",{className:"border-[1px] border-[#DCDCDC] p-2 rounded-[5px] outline-0 w-1/2 sm:w-2/5 lg:w-1/6 text-sm cursor-pointer",children:t.jsx(B,{placeholderText:"Start Date",dateFormat:"yyyy-MM-dd",className:"text-tertiary w-full text-center",selected:h,onChange:e=>G(e),locale:"ja"})}),t.jsx("span",{className:"text-[#808080]",children:"—"}),t.jsx("div",{className:"border-[1px] border-[#DCDCDC] p-2 rounded-[5px] outline-0 w-1/2 sm:w-2/5  lg:w-1/6 text-sm cursor-pointer",children:t.jsx(B,{placeholderText:"End Date",dateFormat:"yyyy-MM-dd",className:"text-tertiary w-full text-center",selected:u,onChange:e=>I(e),locale:"ja",minDate:h})})]})]})}),t.jsx("div",{className:"mt-4 ",children:t.jsxs("div",{className:"flex items-center flex-wrap gap-3 sm:gap-8 ",children:[t.jsxs("div",{className:" grid grid-cols-[110px,1fr]  sm:grid-cols-[142px,1fr] items-center  xs:w-full sm:w-[300px] lg:w-[300px] ",children:[t.jsx("h3",{className:"text-[#808080] text-sm",children:"カテゴリ"}),t.jsxs("select",{id:"first_name",className:"text-tertiary border-[1px] border-[#DCDCDC] p-2  rounded-[5px] outline-0 text-sm cursor-pointer",placeholder:"全て",value:p,onChange:e=>b(e.target.value),children:[t.jsx("option",{className:"text-tertiary",value:"all",children:"全て"}),j.map(e=>t.jsx("option",{className:"text-tertiary",value:e.category_id,children:e.category_name},e.category_id))]})]}),t.jsxs("div",{className:"grid grid-cols-[110px,1fr] sm:grid-cols-[128px,1fr] items-center  xs:w-full sm:w-[200px] lg:w-[200px] ",children:[t.jsxs("h3",{className:"text-[#808080] text-md",children:["サブカテゴリ",t.jsx("span",{className:"xs:hidden sm:hidden md:inline  lg:inline ",children:"ー"})," "]}),t.jsxs("select",{id:"first_name",className:"text-tertiary border-[1px] border-[#DCDCDC] p-2 rounded-[5px] sm:w-[120px] outline-0 text-sm relative cursor-pointer",placeholder:"鋳造",value:C,onChange:e=>q(e.target.value),children:[t.jsx("option",{className:"text-tertiary",value:"",children:"全て"}),H.map(e=>t.jsx("option",{className:"text-tertiary",value:e.category_id,children:e.category_name},e.category_id))]})]})]})}),t.jsx("div",{className:"flex justify-center bg-[#FFF4DF] py-5 my-8",children:t.jsx("button",{type:"submit",className:"lg:bg-[#FFAA00]  md:bg-[#FFAA00]   xs:bg-[#255BB3] rounded  text-[#fff] text-sm font-[700] py-3 px-[6em]",children:"この条件で検索する"})})]}),t.jsxs("form",{onSubmit:$,children:[t.jsxs("div",{className:"grid grid-cols-[112px,189px] items-center mb-8",children:[t.jsx("h3",{className:"text-[#808080] text-sm",children:"都道府県"}),t.jsxs("select",{id:"dropdownHoverButton","data-dropdown-toggle":"dropdownHover","data-dropdown-trigger":"hover",className:" flex justify-between items-center border-[1px] border-[#DCDCDC] text-[#808080] p-2 rounded-[5px] cursor-pointer",value:o,onChange:e=>F(e.target.value),children:[t.jsx("option",{value:"all",children:"全て"}),y.map(e=>t.jsx("option",{value:e,children:e},e)),t.jsx("svg",{className:"w-2.5 h-2.5 ms-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6",children:t.jsx("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 4 4 4-4"})})]})]}),t.jsxs("div",{className:"grid grid-cols-[112px,189px] items-center mb-8",children:[t.jsx("h3",{className:"text-[#808080] text-sm",children:"市区町村"}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("input",{id:"default-checkbox",type:"checkbox",className:"w-4 h-4 outline-none border-none border-[#DCDCDC] rounded cursor-pointer ",checked:c.length===(l==null?void 0:l.map(e=>e==null?void 0:e.cities).flat().length),onChange:()=>D("all")}),t.jsx("h3",{className:"text-[#808080] text-sm",children:"全て"})]})]}),l&&l.map((e,s)=>t.jsxs("div",{children:[t.jsx("div",{className:"bg-[#F8FBFF] p-3 mb-4 ",children:t.jsx("div",{className:"xs:w-2/5 sm:w-[18%]  md:w-[20%] lg:w-[12%]",children:t.jsxs("label",{className:"flex items-center justify-start gap-5 cursor-pointer",children:[t.jsx("span",{className:"text-[#255BB3] font-[500] text-sm  ",children:e==null?void 0:e.area}),t.jsx("input",{type:"checkbox",className:"w-4 h-4 outline-none border-none border-[#DCDCDC] rounded cursor-pointer ",checked:(e==null?void 0:e.cities.length)>0&&(e==null?void 0:e.cities.every(n=>c.includes(n))),onChange:()=>D("area",e==null?void 0:e.area)})]})})}),t.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 gap-4 mb-8",children:(e==null?void 0:e.cities)&&(e==null?void 0:e.cities.map((n,a)=>t.jsx("div",{className:"flex items-center space-x-2",children:t.jsxs("label",{htmlFor:`${n}-${a}`,className:"cursor-pointer flex items-center",children:[t.jsx("input",{id:`${n}-${a}`,type:"checkbox",value:c,className:"w-4 h-4 outline-none border-none border-[#DCDCDC] rounded cursor-pointer",checked:c.includes(n),onChange:()=>D(n)}),t.jsx("span",{className:"text-[#808080] text-sm ml-1",children:n})]})},a)))})]},s)),t.jsx("div",{className:"flex justify-center bg-[#FFF4DF] py-5 mb-20",children:t.jsx("button",{type:"submit",className:"lg:bg-[#FFAA00]  md:bg-[#FFAA00]  xs:bg-[#255BB3] rounded   text-[#fff] text-sm font-[700] py-3 px-[6em]",children:"この条件で検索する"})}),t.jsx("div",{className:"flex justify-center mb-[10em]",children:t.jsx("button",{onClick:()=>w(-1),type:"button",className:"text-[#fff] rounded bg-[#808080] text-sm font-[700] py-4 px-[9em]",children:"戻る"})})]})]})})})};export{ne as default};
