import{a as k,f as A,u as E,r as n,j as e,S as R,b5 as z,h as I}from"./index-w2wx-x_X.js";import{D as L}from"./Dropzone-MJ6J4G2E.js";import{u as O}from"./index.esm-aRdTVIgd.js";import"./tslib.es6-8dbh_m2m.js";const B=()=>{var f,u,h,w,j;const{user:m}=k(A),N=E(),[_,c]=n.useState(!1);n.useState(null);const[,v]=n.useState(!1),[b,r]=n.useState(!1),[,y]=n.useState({_id:"",news_date:new Date,rank:0,news_title:"",news_comment:"",news_select:"",creator_id:"",create_date:new Date,image:null,del_flg:0,shop_id:0,delivery_flg:0,delivery_date:"",news_url:"",delivery_flag:!1,__v:0}),[o,p]=n.useState(null),{register:a,setValue:F,handleSubmit:S,reset:g,formState:{errors:s}}=O(),D=async t=>{c(!0);const l=new FormData;Object.entries(t).forEach(([i,C])=>{i==="image"&&o?l.append("image",o):l.append(i,C.toString())});const x=await z(m==null?void 0:m.token,l);console.log("response",x),x&&x.message==="News added successfully."&&x.news.delivery_flag?I.emit("news",x.news,()=>{c(!1),g(),p(null),r(!0)}):(c(!1),g(),p(null),r(!0))},q=(t,l)=>{l===5&&p(t)},d=t=>{const{name:l,value:x}=t.target;y(i=>({...i,[l]:x}))};return e.jsx(e.Fragment,{children:_?e.jsx(R,{}):e.jsxs("div",{className:" lg:w-[80%] xl:w-[78%] xs:w-[100%] mb-40",children:[e.jsx("div",{className:"lg:mx-20 md:mx-8 xs:mx-8 flex  flex-col mt-[50px] ",children:e.jsxs("div",{className:"flex lg:gap-20 xs:gap-2 items-center",children:[e.jsx("h1",{className:"text-[#808080] font-[700] text-[20px] mb-4",children:"お知らせ編集画面"}),e.jsx("h3",{className:"text-[#FF8080] text-[10px]",children:"※は回答必須"})]})}),e.jsxs("form",{encType:"multipart/form-data",onSubmit:S(D),children:[e.jsx("div",{className:"lg:mx-20 md:mx-8 xs:mx-8 mt-[1rem] lg:w-[100%] xs:w-[85%] sm:w-[80%] ",children:e.jsxs("div",{className:"w-full flex flex-col gap-2  ",children:[e.jsxs("div",{className:"flex xs:flex-col lg:flex-row",children:[e.jsx("label",{className:"text-[#808080]  gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"タイトル"}),e.jsx("input",{type:"text",className:"border outline-0  lg:w-[253px]  xs:w-full h-[36px] px-5 xs:mt-[16px] lg:ml-[50px]  lg:text-[14px] xs:text-[12px] ",...a("news_title",{required:"タイトルは必須です"}),name:"news_title",onChange:d}),(s==null?void 0:s.news_title)&&e.jsx("p",{className:"text-red-500",children:(f=s==null?void 0:s.news_title)==null?void 0:f.message})]}),e.jsxs("div",{className:"flex items-start xs:flex-col lg:flex-row",children:[e.jsx("label",{className:"text-[#808080]  gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"画像"}),e.jsxs("div",{className:"bg-light cursor-pointer col-span-4 flex justify-center items-center xs:mt-[16px] lg:w-[219px] xs:w-[114px] border border-secondary xs:h-[116px] md:h-[140px] lg:ml-[80px]",children:[e.jsx(L,{setValue:F,onFileSelect:t=>q(t,5),isReset:b,...a("image",{required:"images is required"}),isProcess:!0,setDropped:v||(()=>{})}),(s==null?void 0:s.image)&&e.jsx("p",{className:"text-red-500",children:(u=s==null?void 0:s.image)==null?void 0:u.message})]})]}),e.jsxs("div",{className:"flex items-start xs:flex-col lg:flex-row",children:[e.jsx("label",{className:"text-[#808080]  gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"内容"}),e.jsx("textarea",{className:"border outline-0  lg:w-[650px]  xs:w-full h-[230px] p-5 xs:mt-[16px] lg:ml-[80px] lg:text-[14px] xs:text-[12px] resize-none",...a("news_comment",{required:"内容は必須です"}),name:"news_comment",onChange:d}),(s==null?void 0:s.news_comment)&&e.jsx("p",{className:"text-red-500",children:(h=s==null?void 0:s.news_comment)==null?void 0:h.message})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("label",{className:"text-[#808080] flex gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:["公開ステータス",e.jsx("span",{className:"text-[#FF8080]",children:"※"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"radio",name:"delivery_flag",value:"true",...a("delivery_flag",{required:"公開ステータスは必須です"}),className:"border outline-0 ml-[50px] xs:mt-[16px]"}),e.jsx("span",{className:"text-[#808080] lg:text-[14px] xs:text-[12px] ml-[9px]",children:"公開"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"radio",name:"delivery_flag",value:"false",...a("delivery_flag",{required:"公開ステータスは必須です"}),className:"border outline-0 ml-[50px] xs:mt-[16px]"}),e.jsx("span",{className:"text-[#808080] lg:text-[14px] xs:text-[12px] ml-[9px]",children:"非公開"})]}),(s==null?void 0:s.delivery_flag)&&e.jsx("p",{className:"text-red-500",children:(w=s==null?void 0:s.delivery_flag)==null?void 0:w.message})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"text-[#808080]   gap-4 lg:text-[14px] xs:text-[12px] font-bold",children:"配信日"}),e.jsx("input",{type:"date",className:"border outline-0  lg:w-[150px]  xs:w-[150px] h-[36px] px-5 xs:mt-[16px] ml-[65px] lg:text-[14px] xs:text-[12px] ",placeholder:"20/04/2024",...a("delivery_date",{required:"配信日は必須です"}),name:"delivery_date",onChange:d}),(s==null?void 0:s.delivery_date)&&e.jsx("p",{className:"text-red-500",children:(j=s==null?void 0:s.delivery_date)==null?void 0:j.message})]})]})}),e.jsxs("div",{className:"lg:w-[100%] xs:w-full flex justify-center items-center lg:gap-[46px] xs:gap-[10px] mt-[85px]",children:[e.jsx("button",{onClick:()=>N(-1),type:"button",className:"px-5 bg-[#808080] text-[#F8F8F8] xs:w-[161px] lg:w-[194px] h-[36px] lg:text-[14px] xs:text-[12px]",children:"戻る"}),e.jsx("button",{type:"submit",className:"px-2 bg-[#FFAA00] text-[#F8F8F8] xs:w-[161px] lg:w-[194px] h-[36px] lg:text-[14px] xs:text-[12px]",children:"この内容で登録する"})]})]})]})})};export{B as default};
