import{u as F,z as ae,r as n,a as I,f as se,B as ne,d as re,W as oe,Q as le,D as ie,j as a,S as ce,U as L,V as z}from"./index-w2wx-x_X.js";import{r as de,l as me,K as pe}from"./baseline-5AKzli58.js";import{R as xe,D as ue,T as fe,a as he,b as ge,C as ye,c as _e,d as we}from"./CancelProgressReviewModal-Cx-jR9Sa.js";import{o as be}from"./status-transaction-jP2MLjuh.js";import"./emotion-react.browser.esm-kI5PoqX3.js";import"./hoist-non-react-statics.cjs-j2Vrlo-h.js";import"./extends-_9I-EFOp.js";import"./assertThisInitialized-4q6YPdh3.js";import"./memoize-one.esm-oV5jpQgL.js";import"./setPrototypeOf-ahVgEFUp.js";import"./createLucideIcon-HB9nCie5.js";import"./tslib.es6-8dbh_m2m.js";import"./iconBase-7AsOp5YA.js";import"./index.esm-y_8cUbAG.js";const Ie=()=>{var P,B,D,E,R;const g=F(),$=ae(),y=new URLSearchParams($.search).get("page"),[m,Q]=n.useState(y?parseInt(y):1),[_]=n.useState(null),[w,b]=n.useState(!1),[l,j]=n.useState(["10"]),{other:i,partnerResponse:U,loading:q}=I(se),{sellerList:s,transactionStatus:o}=I(ne),[O,p]=n.useState(!1),[H,k]=n.useState(!1),[Z,v]=n.useState(!1),[K,V]=n.useState(""),[W,C]=n.useState(!1),[G,N]=n.useState(!1),[J,x]=n.useState(!1),S=F(),r=re(),A=10,u=Math.max(1,((P=s==null?void 0:s.pagination)==null?void 0:P.currentPage)-Math.floor(A/2)),f=Math.min((B=s==null?void 0:s.pagination)==null?void 0:B.totalPages,u+A-1),X=Array.from({length:f-u+1},(e,t)=>u+t),c=async e=>{Q(e),g(`/dashboard/order-list?page=${e}`)};n.useEffect(()=>{r(oe({status:l,page:m})),r(le({status:l,role:"seller"}))},[l,m,r]),n.useEffect(()=>{r(ie({}))},[r,U]),console.log(s,"sellerList>>>>>>>>>>>>>>"),console.log(o,"transactionStatus");let h=[];if(s&&(s!=null&&s.data))for(let e=0;e<(s==null?void 0:s.data.length);e++){const t=s==null?void 0:s.data[e];h.push({transaction_no:t._id,customer_id:t.customer_id,seller_id:t.seller_id,quotations:t.quotations,conversation:t.conversation,project:t.process_name,company_name:t.sellerDetails[0].name01,transaction_status:t.transaction_status,estimate_name:t.estimate_name,dept_name:t.dept_name,subtotal:t.subtotal,discount:t.discount,charge:t.charge,tax:t.tax,total:t.total,payment_total:t.payment_total,payment_id:t.payment_id,payment_method:t.payment_method,deliv_id:t.deliv_id,status:t.status,issue_date:t.issue_date,expiration_date:t.expiration_date,title:t.title,estimate_number:t.estimate_number,latestQuoteTotalExcludingTax:t.transaction_status===5&&t.refund&&t.refund.taxDetails&&t.refund.taxDetails.totalAmountIncludingTax!==0?t.latestQuoteTotalExcludingTax-t.refund.taxDetails.totalAmountExcludingTax:t.latestQuoteTotalExcludingTax,del_flg:t.del_flg,order_id:t.order_id,zip01:t.zip01,zip02:t.zip02,pref:t.pref,addr01:t.addr01,addr02:t.addr02,transport_costs:t.transport_costs,contract_agree:t.contract_agree,orderer_agree:t.orderer_agree,estimation_pdf:t.estimation_pdf,createdAt:t.createdAt,updatedAt:t.updatedAt,paymentDeposit:t.paymentDeposit,est_amount:52e4,deadline:"21/06/2024",detailed:"詳細",review:"レビュー",cancel:"キャンセル",__v:t.__v})}const Y=[{label:"取引No",key:"transaction_no",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] break-all",style:{whiteSpace:"normal"},children:e.transaction_no?e.transaction_no:"NA"})},{label:"工程",key:"project",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] text-left line-clamp-3",style:{whiteSpace:"normal"},children:e.project?e.project:"NA"})},{label:"企業名",key:"company_name",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] text-left line-clamp-3",style:{whiteSpace:"normal"},children:e.company_name?e.company_name:"NA"})},{label:"ステータス",key:"transaction_status",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] line-clamp-1",style:{whiteSpace:"normal"},children:be[e.transaction_status]||"NA"})},{label:"納期",key:"deadline",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400]",style:{whiteSpace:"normal"},children:e.deadline?e.deadline:"NA"})},{label:"見積金額(税別)",key:"est_amount",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[400] break-all",style:{whiteSpace:"normal"},children:e.latestQuoteTotalExcludingTax})},{label:"詳細",key:"detailed",renderCell:e=>a.jsxs("button",{onClick:()=>g(`/transaction/${e.transaction_no}`),className:"text-[#fff] text-[14px] font-[400] bg-[#FFAA00] px-2 py-1 flex gap-2 items-center  justify-center mx-auto",style:{whiteSpace:"normal"},children:[e.detailed,a.jsx("span",{className:"",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"5",height:"8",viewBox:"0 0 5 8",fill:"none",children:a.jsx("path",{d:"M0.184686 7.38979C0.0700362 7.28623 0.00946618 7.16632 0.00513976 7.02643C0.00081333 6.88654 0.0613833 6.76663 0.184686 6.66308L3.46196 3.91066L0.184686 1.15825C0.0700362 1.06015 0.00946618 0.940239 0.00081333 0.798531C-0.00783952 0.656822 0.0527305 0.533282 0.17387 0.431542C0.290684 0.327986 0.433456 0.2753 0.606513 0.271666C0.77957 0.268033 0.924506 0.318902 1.03916 0.422458L4.84641 3.6109C4.89617 3.65268 4.9351 3.69992 4.96106 3.7526C4.98702 3.80529 5 3.85798 5 3.91248C5 3.96698 4.98702 4.01967 4.96106 4.07236C4.9351 4.12504 4.89833 4.17046 4.84641 4.21407L1.04997 7.39887C0.935322 7.49516 0.792549 7.54421 0.621656 7.54421C0.450762 7.54421 0.305826 7.49334 0.182523 7.38979H0.184686Z",fill:"white"})})})]})},{label:"レビュー",key:"review",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[500] w-fit bg-[#E6E6E6] p-1 text-center mx-auto cursor-pointer",style:{whiteSpace:"normal"},onClick:()=>{e.paymentDeposit?e.transaction_status===5?N(!0):e.transaction_status===6?C(!0):e.transaction_status===8?(r(L(!0)),r(z(!1)),S(`/transaction/${e.transaction_no}`)):x(!0):x(!0)},children:e.review})},{label:"キャンセル",key:"cancel",renderCell:e=>a.jsx("div",{className:"text-[#808080] text-[14px] font-[500] w-fit bg-[#E6E6E6] py-1  text-center mx-auto cursor-pointer",style:{whiteSpace:"normal"},onClick:()=>{e.paymentDeposit?e.transaction_status===5?(k(!0),V(e.transaction_no)):e.transaction_status===6||e.transaction_status===8?v(!0):e.transaction_status!==7&&e.transaction_status!==9?(S(`/transaction/${e.transaction_no}`),r(z(!0)),r(L(!1))):p(!0):p(!0)},children:e.transaction_status===7||e.transaction_status===9?" ":e.cancel})}];let M=h;_!==null&&(M=h.filter(e=>e.transaction_status.toString()===_));const ee={nodes:M},te=de([me(),{HeaderRow:`
        background-color: #255BB3;
        color: #fff;
        font-size: 14px;

      `,Table:`
      --data-table-library_grid-template-columns:1.7fr 1.5fr 1.5fr 1.5fr 1.5fr 1fr 1.2fr 1.5fr 1.5fr;

    @media (max-width: 1150px) {
      --data-table-library_grid-template-columns:repeat(9,minmax(10px,500px));
        overflow-x: auto;
        width: 200% !important;
        white-space: nowrap;
      } 
      @media (max-width: 500px) {
        --data-table-library_grid-template-columns:repeat(9,minmax(10px,500px));
        overflow-x: auto;
        width: 300% !important;
        white-space: nowrap;
      }    
      `,BaseCell:`
         &:nth-of-type(n) {
          font-weight: 500;
          text-align:center;
            align-items:start;
            
          }
        &:nth-of-type(6) {
            text-align:right;
        }
         &:nth-of-type(1) {
            text-align:left;
          }

      `}]),T=[{label:"ALL",key:["10"]},{label:"商談中",key:["1"]},{label:"受発注待ち",key:["2"]},{label:"納品待ち",key:["3"]},{label:"検収中",key:["4"]},{label:"差戻し",key:["5"]},{label:"取引完了",key:["6"]},{label:"キャンセル",key:["7","9"]},{label:"決済完了",key:["8"]}];return a.jsxs(a.Fragment,{children:[q?a.jsx(ce,{}):i&&((D=i==null?void 0:i.user)!=null&&D.partner_flg)?a.jsxs("div",{className:"mx-8 mt-[-0.5rem]",children:[a.jsxs("div",{className:"flex items-center justify-between sm:block my-4",children:[a.jsx("h1",{className:"sm:text-[#255BB3] text-[#808080] font-[700] sm:text-[24px] text-xl mb-4 md:mb-0",children:"受注一覧"}),a.jsxs("div",{className:"flex items-center gap-2 sm:hidden",children:[a.jsxs("h1",{className:"text-[#808080] text-sm font-medium",children:["Filter By :"," "]}),a.jsx("button",{onClick:()=>b(!w),className:"text-white bg-[#FFAA00] px-6 py-1 ",children:a.jsx(xe,{className:"w-6 h-6"})})]})]}),a.jsx("div",{className:"text-[14px] hidden sm:block font-medium text-center text-[#808080] border-b border-gray-200 dark:text-gray-400 dark:border-gray-700",children:a.jsx("ul",{className:"flex flex-wrap -mb-px gap-2 mt-4",children:T.map(e=>a.jsx("li",{className:"me-2",children:a.jsxs("span",{className:`inline-block p-1 text-[14px] ${(Array.isArray(e.key)?e.key.some(t=>l.includes(t)):l.includes(e.key))?"border-b-2 border-[#255BB3] text-[#255BB3]":"border-transparent"} rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 cursor-pointer`,onClick:t=>{t.preventDefault(),j(Array.isArray(e.key)&&e.key.length>1?e.key:Array.isArray(e.key)&&e.key.length===1?[e.key[0]]:[e.key.toString()]),c(1)},children:[e.label,"(",o&&(o!=null&&o.countInfo)?o==null?void 0:o.countInfo.reduce((t,d)=>Array.isArray(e.key)?t+(e.key.includes(d.status.toString())?d.count:0):t+(d.status===parseInt(e.key)?d.count:0),0):0,")"]})},Array.isArray(e.key)?e.key.join("-"):e.key))})}),a.jsx("div",{className:"sm:hidden block",children:a.jsx(ue,{isOpen:w,setIsOpen:b,statusLabels:T,setFilter:j,handlePageChange:c})}),a.jsx("div",{className:"mt-4 border-[1px] border-[#E6E6E6] overflow-x-auto",children:a.jsx(pe,{data:ee,columns:Y,theme:te})}),a.jsxs("div",{className:"col-span-12 bg-[#F5F5F5] h-[60px] flex justify-center items-center gap-2 mt-[50px]",children:[a.jsx("div",{className:"flex gap-1",children:X.map((e,t)=>a.jsx(a.Fragment,{children:a.jsx("button",{className:`border w-[25px] ${m===e?"bg-primary text-white":"bg-white"} border-[#DCDCDC]`,onClick:()=>c(e),children:e},t)}))}),f<s&&((R=(E=s.transactions)==null?void 0:E.pagination)==null?void 0:R.totalPages)&&a.jsxs("div",{className:"flex gap-1 items-center cursor-pointer",onClick:()=>c(f+1),children:[a.jsx("div",{className:"font-[500] text-primary text-[16px] w-full",children:"次ページ"}),a.jsx("svg",{className:"",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"18",viewBox:"0 0 16 18",fill:"none",children:a.jsx("path",{d:"M15.4318 9L0.138137 17.6603L0.138138 0.339745L15.4318 9Z",fill:"#255BB3"})})]})]})]}):a.jsx("div",{className:"flex justify-center xs:gap-2 md:gap-10 w-full h-screen my-[75px]",children:"Become a partner to view this page"}),a.jsx(fe,{cancelModalshow:O,setCancelModal:p}),a.jsx(he,{reviewModalshow:J,setReviewModal:x}),a.jsx(ge,{cancelProgressshow:H,setCancelProgressModal:k,transactionId:K}),a.jsx(ye,{cancelProgressshow:G,setCancelProgressModal:N}),a.jsx(_e,{completedTransactionModalshow:Z,setCompletedTransactionModal:v}),a.jsx(we,{completedTransactionModalshow:W,setCompletedTransactionModal:C})]})};export{Ie as default};
